"use strict";var express=require("express"),Users=require("./users-model"),restrict=require("../middleware/restrict"),router=express.Router();router.get("/",restrict("admin"),function(e,t,r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=t.status(200),e.next=4,regeneratorRuntime.awrap(Users.find());case 4:e.t1=e.sent,e.t0.json.call(e.t0,e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),r(e.t2);case 11:case"end":return e.stop()}},null,null,[[0,8]])}),router.get("/:id",function(t,r,s){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=r.status(200),e.next=4,regeneratorRuntime.awrap(Users.findById(t.params.id));case 4:e.t1=e.sent,e.t0.json.call(e.t0,e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),s(e.t2);case 11:case"end":return e.stop()}},null,null,[[0,8]])}),router.get("/logout",function(e,t,r){e.session.destroy(function(e){e?r(e):t.json({message:"Successfully logged out"})})}),router.put("/:id",function(e,t){Users.update(e.params.id,e.body).then(function(e){t.status(200).json(e)}).catch(function(e){next(e)})}),router.delete("/:id",function(e,t){Users.deleteUser(e.params.id).then(function(e){t.status(200).json({message:"The user has been nuked"})}).catch(function(e){next(e)})}),module.exports=router;